{% extends "base.html" %}

{% block title %}Import Candidates - TalentScope AI{% endblock %}

{% block content %}
<style>
    .import-options {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 2rem;
    }
    .import-option {
        flex-grow: 1;
        text-align: center;
        padding: 1rem;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background: white;
        cursor: pointer;
        transition: all 0.2s;
    }
    .import-option:hover, .import-option.active {
        border-color: var(--primary-cyan);
        box-shadow: 0 4px 12px rgba(23, 162, 184, 0.15);
        transform: translateY(-2px);
    }
    .import-option i {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        display: block;
    }
    .import-option.linkedin i { color: #0077B5; }
    .import-option.pdf i { color: var(--d1000-orange); }
    .import-option.csv i { color: var(--d1000-green); }

    .import-form {
        display: none;
    }
    .import-form.active {
        display: block;
    }
</style>

<div class="page-header">
    <h1><i class="fas fa-user-plus me-3"></i>Import Candidates</h1>
    <p class="text-muted mb-0">Job: <strong>{{ job.title }}</strong> - {{ job.level }}</p>
</div>

<div class="import-options">
    <div class="import-option linkedin" data-form="linkedin">
        <i class="fab fa-linkedin"></i>
        <strong>From LinkedIn</strong>
        <small class="d-block text-muted">Individual</small>
    </div>
    <div class="import-option pdf" data-form="pdf">
        <i class="fas fa-file-pdf"></i>
        <strong>From PDF</strong>
        <small class="d-block text-muted">Bulk</small>
    </div>
    <div class="import-option csv" data-form="csv">
        <i class="fas fa-file-csv"></i>
        <strong>From CSV</strong>
        <small class="d-block text-muted">Bulk</small>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div id="linkedin-form" class="import-form">
            <div class="card">
                <div class="card-header" style="background: #0077B5; color: white;">
                    <i class="fab fa-linkedin me-2"></i>From LinkedIn
                </div>
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="import_type" value="linkedin">
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">Name *</label>
                            <input type="text" class="form-control" name="candidate_name" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">E-mail</label>
                            <input type="email" class="form-control" name="candidate_email">
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">LinkedIn URL *</label>
                            <input type="url" class="form-control" name="linkedin_url" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">Copy Profile *</label>
                            <textarea class="form-control" name="profile_text" rows="6" required placeholder="Paste the LinkedIn profile text here"></textarea>
                            <small class="text-muted">Copy and paste the profile information</small>
                        </div>
                        
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fab fa-linkedin me-2"></i>Import
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div id="pdf-form" class="import-form">
            <div class="card">
                <div class="card-header" style="background: var(--d1000-orange); color: white;">
                    <i class="fas fa-file-pdf me-2"></i>From PDF
                </div>
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="import_type" value="pdf">
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">PDF Resumes *</label>
                            <input type="file" class="form-control" name="pdf_files" accept=".pdf" multiple required>
                            <small class="text-muted">Multiple files allowed</small>
                        </div>
                        
                        <div class="alert alert-info small">
                            <i class="fas fa-info-circle me-2"></i>
                            The AI will automatically extract name, contacts, skills and experience
                        </div>
                        
                        <button type="submit" class="btn btn-warning w-100" style="color: var(--d1000-dark);">
                            <i class="fas fa-upload me-2"></i>Upload
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div id="csv-form" class="import-form">
            <div class="card">
                <div class="card-header" style="background: var(--d1000-green); color: white;">
                    <i class="fas fa-file-csv me-2"></i>From CSV
                </div>
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="import_type" value="csv">
                        
                        <div class="mb-3">
                            <label class="form-label fw-bold">CSV File *</label>
                            <input type="file" class="form-control" name="csv_file" accept=".csv" required>
                        </div>
                        
                        <div class="alert alert-warning small">
                            <strong>Expected columns:</strong>
                            <ul class="mb-0 mt-2 small">
                                <li>Nome or Name</li>
                                <li>Email (optional)</li>
                                <li>Phone (optional)</li>
                            </ul>
                        </div>
                        
                        <button type="submit" class="btn btn-success w-100">
                            <i class="fas fa-upload me-2"></i>Import CSV
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card mt-4">
    <div class="card-header">
        <i class="fas fa-question-circle me-2"></i>How it Works
    </div>
    <div class="card-body">
        <div class="row text-center">
            <div class="col-md-3 mb-3">
                <div style="width: 60px; height: 60px; background: var(--d1000-blue); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold; margin-bottom: 10px;">1</div>
                <h6>Choose the Method</h6>
                <p class="small text-muted">LinkedIn, PDF or CSV</p>
            </div>
            
            <div class="col-md-3 mb-3">
                <div style="width: 60px; height: 60px; background: var(--d1000-green); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold; margin-bottom: 10px;">2</div>
                <h6>Import</h6>
                <p class="small text-muted">Upload or fill in data</p>
            </div>
            
            <div class="col-md-3 mb-3">
                <div style="width: 60px; height: 60px; background: var(--d1000-yellow); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; color: var(--d1000-dark); font-size: 24px; font-weight: bold; margin-bottom: 10px;">3</div>
                <h6>AI Analyzes</h6>
                <p class="small text-muted">Analysis in seconds</p>
            </div>
            
            <div class="col-md-3 mb-3">
                <div style="width: 60px; height: 60px; background: var(--d1000-orange); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold; margin-bottom: 10px;">4</div>
                <h6>See Ranking</h6>
                <p class="small text-muted">Sorted by score</p>
            </div>
        </div>
    </div>
</div>

<div class="mt-3">
    <a href="{{ url_for('view_job', job_id=job.id) }}" class="btn btn-secondary">
        <i class="fas fa-arrow-left me-2"></i>Back
    </a>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const options = document.querySelectorAll('.import-option');
    const forms = document.querySelectorAll('.import-form');

    options.forEach(option => {
        option.addEventListener('click', function() {
            const formId = this.dataset.form + '-form';
            
            // Toggle active class on options
            options.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');

            // Show the selected form and hide others
            forms.forEach(form => {
                if (form.id === formId) {
                    form.classList.add('active');
                } else {
                    form.classList.remove('active');
                }
            });
        });
    });

    // Optional: open the first form by default
    if(options.length > 0) {
        options[0].click();
    }
});
</script>
{% endblock %}